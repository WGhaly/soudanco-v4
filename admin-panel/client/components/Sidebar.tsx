import { Link, useLocation, useNavigate } from "react-router-dom";
import { cn } from "@/lib/utils";
import { useAuth } from "@/lib/auth";

interface NavItem {
  label: string;
  icon: React.ReactNode;
  href: string;
}

const navItems: NavItem[] = [
  {
    label: "لوحة التحكم",
    href: "/",
    icon: (
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M2.5 7.49999L10 1.66666L17.5 7.49999V16.6667C17.5 17.1087 17.3244 17.5326 17.0118 17.8452C16.6993 18.1577 16.2754 18.3333 15.8333 18.3333H4.16667C3.72464 18.3333 3.30072 18.1577 2.98816 17.8452C2.67559 17.5326 2.5 17.1087 2.5 16.6667V7.49999Z" fill="currentColor"/>
        <path d="M7.5 18.3333V10H12.5V18.3333" fill="currentColor"/>
      </svg>
    ),
  },
  {
    label: "العملاء",
    href: "/customers",
    icon: (
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M14.1667 17.5V15.8333C14.1667 14.9493 13.8155 14.1014 13.1904 13.4763C12.5652 12.8512 11.7174 12.5 10.8333 12.5H4.16667C3.28261 12.5 2.43476 12.8512 1.80964 13.4763C1.18452 14.1014 0.833336 14.9493 0.833336 15.8333V17.5" fill="currentColor"/>
        <path d="M7.50001 9.16667C9.34096 9.16667 10.8333 7.67428 10.8333 5.83333C10.8333 3.99238 9.34096 2.5 7.50001 2.5C5.65906 2.5 4.16667 3.99238 4.16667 5.83333C4.16667 7.67428 5.65906 9.16667 7.50001 9.16667Z" fill="currentColor"/>
        <path d="M19.1667 17.5V15.8333C19.1661 15.0948 18.9202 14.3773 18.4679 13.7936C18.0157 13.2099 17.3816 12.793 16.6667 12.6083" fill="currentColor"/>
        <path d="M13.3333 2.60834C14.0503 2.79192 14.6865 3.20892 15.1399 3.79359C15.5933 4.37827 15.8398 5.09736 15.8398 5.8375C15.8398 6.57765 15.5933 7.29674 15.1399 7.88141C14.6865 8.46609 14.0503 8.88309 13.3333 9.06667" fill="currentColor"/>
      </svg>
    ),
  },
  {
    label: "المنتجات",
    href: "/products",
    icon: (
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10 0.833344L1.66667 5.00001L10 9.16668L18.3333 5.00001L10 0.833344Z" fill="currentColor"/>
        <path d="M1.66667 14.1667L10 18.3333L18.3333 14.1667" fill="currentColor"/>
        <path d="M1.66667 9.58334L10 13.75L18.3333 9.58334" fill="currentColor"/>
      </svg>
    ),
  },
  {
    label: "قائمات الاسعار",
    href: "/price-lists",
    icon: (
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.8333 2.5H4.16667C3.24619 2.5 2.5 3.24619 2.5 4.16667V15.8333C2.5 16.7538 3.24619 17.5 4.16667 17.5H15.8333C16.7538 17.5 17.5 16.7538 17.5 15.8333V4.16667C17.5 3.24619 16.7538 2.5 15.8333 2.5Z" fill="currentColor"/>
        <path d="M10 5.83334V14.1667" stroke="white" strokeWidth="2"/>
        <path d="M7.5 7.5H11.25C11.5815 7.5 11.8995 7.6317 12.1339 7.86612C12.3683 8.10054 12.5 8.41848 12.5 8.75C12.5 9.08152 12.3683 9.39946 12.1339 9.63388C11.8995 9.8683 11.5815 10 11.25 10H7.5" stroke="white" strokeWidth="2"/>
      </svg>
    ),
  },
  {
    label: "الطلبات",
    href: "/orders",
    icon: (
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12.5 1.66666H3.33333C2.8731 1.66666 2.5 2.03976 2.5 2.49999V17.5C2.5 17.9602 2.8731 18.3333 3.33333 18.3333H16.6667C17.1269 18.3333 17.5 17.9602 17.5 17.5V6.66666L12.5 1.66666Z" fill="currentColor"/>
        <path d="M12.5 1.66666V6.66666H17.5" stroke="white" strokeWidth="2"/>
        <path d="M13.3333 10.8333H6.66667" stroke="white" strokeWidth="2"/>
        <path d="M13.3333 14.1667H6.66667" stroke="white" strokeWidth="2"/>
        <path d="M8.33333 7.5H7.5H6.66667" stroke="white" strokeWidth="2"/>
      </svg>
    ),
  },
  {
    label: "المدفوعات",
    href: "/payments",
    icon: (
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M16.6667 3.33334H3.33333C2.41286 3.33334 1.66667 4.07953 1.66667 5.00001V15C1.66667 15.9205 2.41286 16.6667 3.33333 16.6667H16.6667C17.5871 16.6667 18.3333 15.9205 18.3333 15V5.00001C18.3333 4.07953 17.5871 3.33334 16.6667 3.33334Z" fill="currentColor"/>
        <path d="M1.66667 8.33334H18.3333" stroke="white" strokeWidth="2"/>
      </svg>
    ),
  },
  {
    label: "الخصومات",
    href: "/discounts",
    icon: (
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M18.3333 9.23334L10.7667 1.66667C10.5333 1.43334 10.2167 1.3 9.88333 1.3H2.5C1.83333 1.3 1.3 1.83334 1.3 2.5V9.88334C1.3 10.2167 1.43333 10.5333 1.66667 10.7667L9.23333 18.3333C9.7 18.8 10.45 18.8 10.9167 18.3333L18.3333 10.9167C18.8 10.45 18.8 9.7 18.3333 9.23334Z" fill="currentColor"/>
        <circle cx="5.83333" cy="5.83334" r="1.25" fill="white"/>
      </svg>
    ),
  },
  {
    label: "المكافآت",
    href: "/rewards",
    icon: (
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10 1.66667L12.5817 6.88334L18.3333 7.72501L14.1667 11.7833L15.1633 17.5L10 14.8083L4.83667 17.5L5.83333 11.7833L1.66667 7.72501L7.41833 6.88334L10 1.66667Z" fill="currentColor" stroke="white" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
      </svg>
    ),
  },
];

const bottomNavItems: NavItem[] = [
  {
    label: "الخروج",
    href: "/logout",
    icon: (
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.5 17.5H4.16667C3.72464 17.5 3.30072 17.3244 2.98816 17.0118C2.67559 16.6993 2.5 16.2754 2.5 15.8333V4.16667C2.5 3.72464 2.67559 3.30072 2.98816 2.98816C3.30072 2.67559 3.72464 2.5 4.16667 2.5H7.5" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M13.3333 14.1667L17.5 10L13.3333 5.83334" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M17.5 10H7.5" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
      </svg>
    ),
  },
];

export default function Sidebar() {
  const location = useLocation();
  const navigate = useNavigate();
  const { logout } = useAuth();

  const handleLogout = async () => {
    await logout();
    navigate('/login');
  };

  return (
    <aside className="flex flex-col justify-between items-end min-h-screen rounded-[20px] border-r border-theme-border bg-white shadow-[0_5px_15px_0_rgba(0,0,0,0.15)] p-4 pb-8">
      <div className="flex flex-col items-end gap-6 self-stretch">
        {/* Logo */}
        <Link to="/" className="flex justify-end items-center gap-3 self-stretch rounded-2xl bg-brand-primary shadow-[0_-1px_0_0_rgba(0,0,0,0.13)_inset] px-4 py-3">
          <svg width="34" height="29" viewBox="0 0 34 29" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21.8237 23.338C21.8237 22.1676 21.8056 20.9964 21.8237 19.8223C21.8745 17.1597 23.0783 15.1964 25.4714 14.1575C27.8427 13.125 30.0616 13.5755 31.9803 15.3408C33.6994 16.9219 34.289 19.6104 33.4671 21.8817C32.6298 24.1947 30.5424 25.7767 28.1865 25.8887C27.2358 25.9331 26.3169 25.8045 25.4542 25.3854C25.153 25.2401 25.0596 25.2929 25.0704 25.6342C25.0877 26.2032 25.0904 26.7741 25.0704 27.343C25.0396 28.2173 24.5515 28.7993 23.7378 28.9732C23.3941 29.0364 23.0396 28.9871 22.725 28.8322C22.4105 28.6773 22.1522 28.4248 21.987 28.1109C21.8626 27.8462 21.8049 27.5539 21.8192 27.2607C21.8234 25.9544 21.8249 24.6468 21.8237 23.338ZM30.7239 19.7723C30.7161 18.9938 30.4096 18.2493 29.87 17.6985C29.3304 17.1477 28.6007 16.8343 27.8373 16.8257C26.2779 16.821 24.9344 18.1746 24.9262 19.7594C24.9189 21.3599 26.2815 22.7496 27.8482 22.7385C29.4148 22.7274 30.7248 21.3729 30.7239 19.7723Z" fill="#FFCD39"/>
            <path d="M14.9365 13.6523C18.2985 13.6708 20.9483 16.4214 20.9238 19.8667C20.8993 23.2112 18.2023 25.9127 14.8939 25.9016C14.1053 25.8988 13.3249 25.7375 12.5974 25.4271C11.8698 25.1167 11.2094 24.6631 10.6537 24.0924C9.53144 22.9397 8.90415 21.3796 8.90981 19.7552C8.91546 18.1309 9.55359 16.5753 10.6838 15.4308C11.8141 14.2863 13.3438 13.6466 14.9365 13.6523ZM17.7986 19.8131C17.8422 18.2458 16.5649 16.8803 15.0046 16.8257C13.476 16.7729 12.0817 18.0663 12.0372 19.579C11.9864 21.3063 13.202 22.6737 14.8449 22.7366C16.4134 22.7958 17.7578 21.47 17.7986 19.8131Z" fill="#FFCD39"/>
            <path d="M4.91331 12.0675C3.48649 12.0691 2.08313 11.6973 0.837426 10.9878C0.2641 10.6668 -0.0788072 10.1709 0.0155376 9.47332C0.0989965 8.8516 0.469119 8.43712 1.05787 8.26319C1.54411 8.11887 2.00585 8.22341 2.4558 8.46118C3.39653 8.95615 4.38715 9.24758 5.46123 9.16153C5.65753 9.1523 5.85069 9.10783 6.03184 9.03016C6.13174 8.99195 6.21975 8.92704 6.28662 8.84224C6.35349 8.75744 6.39677 8.65586 6.41194 8.54814C6.44278 8.2891 6.26951 8.15217 6.08082 8.04578C5.68076 7.82096 5.23988 7.70624 4.80444 7.58319C3.90454 7.32044 3.00191 7.06417 2.17368 6.61176C1.07873 6.0178 0.313087 5.18236 0.304016 3.83624C0.295851 2.45588 0.877342 1.39933 2.06391 0.722103C3.57433 -0.142009 5.18273 -0.123505 6.81744 0.230837C7.36607 0.341785 7.89842 0.52431 8.40134 0.773913C9.16426 1.16711 9.45002 1.8943 9.16608 2.66589C8.91117 3.35792 8.08565 3.75945 7.32908 3.53926C6.77752 3.3792 6.24048 3.17474 5.68802 3.01653C5.20632 2.87868 4.61213 2.83705 4.13224 2.99433C4.01061 3.02857 3.89969 3.09421 3.8102 3.18492C3.75027 3.25205 3.7121 3.3364 3.7009 3.42647C3.6897 3.51654 3.706 3.60794 3.7476 3.68821C3.79736 3.76688 3.86368 3.83325 3.94174 3.8825C4.55498 4.30623 5.39319 4.40892 6.08808 4.61431C6.64121 4.76811 7.18469 4.95595 7.71553 5.17681C9.03454 5.74857 9.80654 6.71168 9.802 8.22248C9.79746 9.73329 9.12435 10.8398 7.78266 11.5013C6.87187 11.9435 5.90483 12.0647 4.91331 12.0675Z" fill="#FFCD39"/>
            <path d="M21.3865 4.94552C21.3547 5.82906 21.5044 6.93464 21.3329 8.01339C20.8975 10.7427 18.3239 12.6124 15.5833 12.2553C13.1177 11.9334 11.3687 10.2782 10.9985 7.907C10.9683 7.69254 10.954 7.47604 10.9559 7.25938C10.9559 5.48736 10.9559 3.71596 10.9559 1.94518C10.9559 0.927492 11.6181 0.21881 12.567 0.204007C13.4878 0.191055 14.1927 0.933043 14.1945 1.92853C14.1981 3.66971 14.1981 5.41057 14.1945 7.15113C14.1945 7.99582 14.5673 8.61106 15.3248 8.93117C16.1059 9.26145 16.867 9.17726 17.5374 8.61753C18.0363 8.20213 18.1624 7.62852 18.1597 7.00126C18.1542 5.27427 18.1542 3.54727 18.1597 1.82028C18.1597 1.10698 18.538 0.579627 19.1757 0.328905C19.4795 0.207257 19.8119 0.180034 20.1309 0.250662C20.4499 0.321291 20.7412 0.486614 20.9683 0.725805C21.1062 0.871203 21.2142 1.04325 21.2861 1.23184C21.3579 1.42043 21.392 1.62175 21.3865 1.82398C21.3865 2.79542 21.3865 3.76685 21.3865 4.94552Z" fill="#FFCD39"/>
            <path d="M22.8216 7.33062C22.8488 6.46373 22.7254 5.3785 22.8697 4.30992C23.1509 2.23383 24.7112 0.62681 26.8358 0.138318C29.276 -0.422337 31.7726 0.760959 32.8076 2.9712C33.1034 3.59777 33.2566 4.28436 33.2558 4.97975C33.2558 6.76842 33.2558 8.55493 33.2558 10.3393C33.2558 11.357 32.5972 12.0583 31.6419 12.0629C30.7003 12.0675 30.0181 11.3542 30.0154 10.3476C30.0154 8.65269 30.0018 6.9587 30.0154 5.2647C30.0235 4.47368 29.7831 3.82883 29.0846 3.44859C28.3526 3.05076 27.5987 3.07852 26.8802 3.50872C26.1999 3.9158 26.0329 4.58655 26.0329 5.33132C26.0329 7.02531 26.0329 8.7193 26.0329 10.4133C26.0329 11.1729 25.6773 11.7085 25.0287 11.9556C24.7089 12.0796 24.3592 12.0997 24.0277 12.013C23.6962 11.9264 23.3991 11.7373 23.1772 11.4717C22.9359 11.1906 22.8064 10.8275 22.8143 10.454C22.8243 9.48257 22.8216 8.51206 22.8216 7.33062Z" fill="#FFCD39"/>
            <path d="M0.240513 17.7481C0.240513 16.5768 0.235978 15.4055 0.240513 14.2324C0.249585 13.2961 0.900021 12.6485 1.81898 12.6346C2.73793 12.6208 3.4047 13.261 3.45912 14.1815C3.4818 14.5562 3.27769 15.0651 3.57705 15.2705C3.84195 15.4555 4.30278 15.3371 4.68289 15.338C5.77783 15.3426 6.38109 15.7525 6.55164 16.6166C6.59689 16.8357 6.59528 17.0623 6.54692 17.2808C6.49856 17.4992 6.40457 17.7045 6.27138 17.8826C6.13819 18.0606 5.96891 18.2073 5.77509 18.3126C5.58128 18.418 5.36748 18.4794 5.14826 18.4928C4.69468 18.5178 4.2411 18.5012 3.78752 18.4928C3.55891 18.4864 3.45731 18.5733 3.46003 18.8129C3.46729 19.5364 3.43645 20.2627 3.47636 20.9852C3.51446 21.6875 3.81201 22.2648 4.47424 22.5691C5.13647 22.8735 5.76332 22.7357 6.34299 22.2971C7.10592 21.7208 8.03031 21.8235 8.56463 22.5257C9.09895 23.2279 8.98828 24.24 8.23896 24.8201C6.62603 26.07 4.84708 26.2865 3.03457 25.403C1.25654 24.5361 0.301294 23.0262 0.246864 20.988C0.217835 19.9065 0.24142 18.8268 0.240513 17.7481Z" fill="#FFCD39"/>
          </svg>
          <span className="flex-1 text-white text-2xl font-medium text-right leading-[120%]">سودانكو</span>
        </Link>

        {/* Navigation */}
        <nav className="flex flex-col items-start gap-1 w-[178px]">
          {navItems.map((item) => (
            <Link
              key={item.href}
              to={item.href}
              className={cn(
                "flex flex-col items-start gap-1.5 self-stretch rounded-[10px] px-4 py-2",
                location.pathname === item.href && "bg-brand-primary/10"
              )}
            >
              <div className="flex items-center gap-4 self-stretch rounded border border-transparent">
                <div
                  className={cn(
                    "flex flex-col justify-center items-center",
                    location.pathname === item.href ? "text-brand-primary" : "text-body-text"
                  )}
                >
                  {item.icon}
                </div>
                <span
                  className={cn(
                    "flex-1 text-right text-base font-normal leading-[130%]",
                    location.pathname === item.href ? "text-brand-primary" : "text-body-text"
                  )}
                >
                  {item.label}
                </span>
              </div>
            </Link>
          ))}
        </nav>
      </div>

      {/* Bottom navigation - Logout */}
      <div className="flex flex-col items-start gap-1 self-stretch">
        <div className="flex flex-col items-start gap-1 self-stretch px-4">
          <button
            onClick={handleLogout}
            className="flex flex-col items-start gap-1.5 self-stretch rounded-[10px] px-6 py-2 w-full hover:bg-gray-100 transition-colors"
          >
            <div className="flex items-center gap-4 self-stretch rounded border border-transparent">
              <div className="flex flex-col justify-center items-center text-body-text">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M7.5 17.5H4.16667C3.72464 17.5 3.30072 17.3244 2.98816 17.0118C2.67559 16.6993 2.5 16.2754 2.5 15.8333V4.16667C2.5 3.72464 2.67559 3.30072 2.98816 2.98816C3.30072 2.67559 3.72464 2.5 4.16667 2.5H7.5" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                  <path d="M13.3333 14.1667L17.5 10L13.3333 5.83334" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                  <path d="M17.5 10H7.5" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                </svg>
              </div>
              <span className="flex-1 text-body-text text-right text-base font-normal leading-[130%]">
                الخروج
              </span>
            </div>
          </button>
        </div>
      </div>
    </aside>
  );
}
